!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/data-tools",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(s){"use strict";var e=s?s._modules:{};function t(e,t,o,r){e.hasOwnProperty(t)||(e[t]=r.apply(null,o),"function"==typeof CustomEvent&&s.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Data/Modifiers/DataModifier.js",[e["Core/Utilities.js"]],function(e){const{addEvent:o,fireEvent:t,merge:a}=e;class r{benchmark(e,t){const o=[],r=this,s=()=>{r.modifyTable(e),r.emit({type:"afterBenchmarkIteration"})};const n=a({iterations:1},t)["iterations"],i=(r.on("afterBenchmarkIteration",()=>{o.length===n?r.emit({type:"afterBenchmark",results:o}):s()}),{startTime:0,endTime:0});return r.on("modify",()=>{i.startTime=window.performance.now()}),r.on("afterModify",()=>{i.endTime=window.performance.now(),o.push(i.endTime-i.startTime)}),s(),o}emit(e){t(this,e.type,e)}modify(o,r){const s=this;return new Promise((e,t)=>{o.modified===o&&(o.modified=o.clone(!1,r));try{e(s.modifyTable(o,r))}catch(e){s.emit({type:"error",detail:r,table:o}),t(e)}})}modifyCell(e,t,o,r,s){return this.modifyTable(e)}modifyColumns(e,t,o,r){return this.modifyTable(e)}modifyRows(e,t,o,r){return this.modifyTable(e)}on(e,t){return o(this,e,t)}}var s;return(s=r=r||{}).types={},s.registerType=function(e,t){return!!e&&!s.types[e]&&!!(s.types[e]=t)},r}),t(e,"Data/DataTable.js",[e["Core/Utilities.js"]],function(e){const{addEvent:o,fireEvent:t,uniqueKey:c}=e;class m{static isNull(o){if(o===m.NULL)return!0;if(o instanceof Array){if(!o.length)return!1;for(let e=0,t=o.length;e<t;++e)if(null!==o[e])return!1}else{var r=Object.keys(o);if(!r.length)return!1;for(let e=0,t=r.length;e<t;++e)if(null!==o[r[e]])return!1}return!0}constructor(e={}){this.aliases=e.aliases?JSON.parse(JSON.stringify(e.aliases)):{},this.autoId=!e.id,this.columns={},this.id=e.id||c(),(this.modified=this).rowCount=0,this.versionTag=c(),this.rowKeysId=e.rowKeysId;const s=e.columns||{},n=Object.keys(s),i=this.columns;let a=0;for(let e=0,t=n.length,o,r;e<t;++e)r=n[e],o=s[r].slice(),i[r]=o,a=Math.max(a,o.length);for(let e=0,t=n.length;e<t;++e)i[n[e]].length=a;this.rowCount=a;const r=e.aliases||{},l=Object.keys(r),u=this.aliases;for(let e=0,t=l.length,o;e<t;++e)o=l[e],u[o]=r[o];this.setRowKeysColumn(a)}clone(e,t){const o=this,r={},s=(o.emit({type:"cloneTable",detail:t}),e||(r.aliases=o.aliases,r.columns=o.columns),o.autoId||(r.id=o.id),o.rowKeysId&&(r.rowKeysId=o.rowKeysId),new m(r));return e||(s.versionTag=o.versionTag),o.emit({type:"afterCloneTable",detail:t,tableClone:s}),s}deleteColumnAlias(e){const t=this,o=t.aliases,r=o[e],s=t.modifier;return r&&(delete t.aliases[e],s&&s.modifyColumns(t,{[r]:new Array(t.rowCount)},0)),r}deleteColumns(s,t){const o=this,n=o.columns,i={},a={},r=o.modifier,l=o.rowCount;if((s=s||Object.keys(n)).length){o.emit({type:"deleteColumns",columnNames:s,detail:t});for(let e=0,t=s.length,o,r;e<t;++e)r=s[e],(o=n[r])&&(i[r]=o,a[r]=new Array(l)),delete n[r];let e=Object.keys(n).length;return o.rowKeysId&&1===e&&(delete n[o.rowKeysId],e=0),e||(o.rowCount=0),r&&r.modifyColumns(o,a,0,t),o.emit({type:"afterDeleteColumns",columns:i,columnNames:s,detail:t}),i}}deleteRows(s,n=1,e){const i=this,a=[],l=[],t=i.modifier;if(i.emit({type:"deleteRows",detail:e,rowCount:n,rowIndex:s||0}),void 0===s&&(s=0,n=i.rowCount),0<n&&s<i.rowCount){var u=i.columns,c=Object.keys(u);for(let o=0,e=c.length,t,r;o<e;++o){r=(t=u[c[o]]).splice(s,n),o||(i.rowCount=t.length);for(let e=0,t=r.length;e<t;++e)a[e]=a[e]||[],a[e][o]=r[e];l.push(new Array(e))}}return t&&t.modifyRows(i,l,s||0,e),i.emit({type:"afterDeleteRows",detail:e,rowCount:n,rowIndex:s||0,rows:a}),a}emit(e){switch(e.type){case"afterDeleteColumns":case"afterDeleteRows":case"afterSetCell":case"afterSetColumns":case"afterSetRows":this.versionTag=c()}t(this,e.type,e)}getCell(e,t){e=this.aliases[e]||e;e=this.columns[e];if(e)return e[t]}getCellAsBoolean(e,t){e=this.aliases[e]||e;e=this.columns[e];return!(!e||!e[t])}getCellAsNumber(e,t,o){e=this.aliases[e]||e;e=this.columns[e];let r=e&&e[t];switch(typeof r){case"boolean":return r?1:0;case"number":return isNaN(r)&&!o?null:r}return r=parseFloat(""+(r??"")),isNaN(r)&&!o?null:r}getCellAsString(e,t){e=this.aliases[e]||e;e=this.columns[e];return""+(e&&e[t])}getColumn(e,t){return this.getColumns([e],t)[e]}getColumnAsNumbers(t,e){const o=this.columns[t=this.aliases[t]||t],r=[];if(o){var s=o.length;if(e)for(let e=0;e<s;++e)r.push(this.getCellAsNumber(t,e,!0));else{for(let e=0,t;e<s;++e){if("number"==typeof(t=o[e]))return o.slice();if(null!=t)break}for(let e=0;e<s;++e)r.push(this.getCellAsNumber(t,e))}}return r}getColumnNames(){var e=Object.keys(this.columns);return this.removeRowKeysColumn(e),e}getColumns(s,n){const i=this.aliases,a=this.columns,l={};s=s||Object.keys(a),this.removeRowKeysColumn(s);for(let e=0,t=s.length,o,r;e<t;++e)r=s[e],(o=a[i[r]||r])&&(l[r]=n?o:o.slice());return l}getModifier(){return this.modifier}getRow(e,t){return this.getRows(e,1,t)[0]}getRowCount(){return this.rowCount}getRowIndexBy(e,t,o){e=this.aliases[e]||e;const r=this.columns[e];if(r){e=r.indexOf(t,o);if(-1!==e)return e}}getRowObject(e,t){return this.getRowObjects(e,1,t)[0]}getRowObjects(n=0,i=this.rowCount-n,a){const l=this.aliases,u=this.columns,c=new Array(i);a=a||Object.keys(u),this.removeRowKeysColumn(a);for(let e=n,t=0,o=Math.min(this.rowCount,n+i),r,s;e<o;++e,++t){s=c[t]={};for(const m of a)r=u[l[m]||m],s[m]=r?r[e]:void 0}return c}getRows(n=0,i=this.rowCount-n,a){const l=this.aliases,u=this.columns,c=new Array(i);a=a||Object.keys(u);for(let e=n,t=0,o=Math.min(this.rowCount,n+i),r,s;e<o;++e,++t){s=c[t]=[];for(const m of a)r=u[l[m]||m],s.push(r?r[e]:void 0)}return c}getVersionTag(){return this.versionTag}hasColumns(r){var s=this.aliases,n=this.columns;for(let e=0,t=r.length,o;e<t;++e)if(!n[o=r[e]]&&!s[o])return!1;return!0}hasRowWith(e,t){e=this.aliases[e]||e;const o=this.columns[e];return!!o&&-1!==o.indexOf(t)}on(e,t){return o(this,e,t)}renameColumn(e,t){const o=this.columns;if(o[e]){if(e!==t){const r=this.aliases;r[t]&&delete r[t],o[t]=o[e],delete o[e],this.rowKeysId&&this.moveRowKeysColumnToLast(o,this.rowKeysId)}return!0}return!1}setCell(e,t,o,r){const s=this,n=s.columns,i=s.modifier;e=s.aliases[e]||e;let a=n[e];a&&a[t]===o||(s.emit({type:"setCell",cellValue:o,columnName:e,detail:r,rowIndex:t}),a=a||(n[e]=new Array(s.rowCount)),t>=s.rowCount&&(s.rowCount=t+1),a[t]=o,i&&i.modifyCell(s,e,t,o),s.emit({type:"afterSetCell",cellValue:o,columnName:e,detail:r,rowIndex:t}))}setColumn(e,t=[],o=0,r){this.setColumns({[e]:t},o,r)}setColumns(s,n,e){const i=this,a=i.columns,t=i.modifier,l=void 0===n,u=Object.keys(s);i.emit({type:"setColumns",columns:s,columnNames:u,detail:e,rowIndex:n});for(let e=0,t=u.length,o,r;e<t;++e)if(r=u[e],o=s[r],r=i.aliases[r]||r,l)a[r]=o.slice(),i.rowCount=o.length;else{const c=a[r]||(a[r]=new Array(i.rowCount));for(let e=n||0,t=o.length;e<t;++e)c[e]=o[e];i.rowCount=Math.max(i.rowCount,c.length)}var o=Object.keys(a);for(let e=0,t=o.length;e<t;++e)a[o[e]].length=i.rowCount;t&&t.modifyColumns(i,s,n||0),i.rowKeysId&&this.moveRowKeysColumnToLast(a,i.rowKeysId),i.emit({type:"afterSetColumns",columns:s,columnNames:u,detail:e,rowIndex:n})}setRowKeysColumn(t){var o=this.rowKeysId;if(o){this.columns[o]=[];const r=this.columns[o];for(let e=0;e<t;e++)r.push(o+"_"+e)}}getRowKeysColumn(){var e=this.rowKeysId;if(e)return this.columns[e]}getRowIndexOriginal(e){var t=this.rowKeysId;if(t){const o=""+this.columns[t][e];return o.split("_")[1]}return String(e)}setModifier(t,o){const r=this;let e;return r.emit({type:"setModifier",detail:o,modifier:t,modified:r.modified}),(r.modified=r).modifier=t,(e=t?t.modify(r):Promise.resolve(r)).then(e=>(e.emit({type:"afterSetModifier",detail:o,modifier:t,modified:e.modified}),e)).catch(e=>{throw r.emit({type:"setModifierError",error:e,modifier:t,modified:r.modified}),e})}setRow(e,t,o){this.setRows([e],t,o)}setRows(t,o=this.rowCount,e){const r=this,n=r.aliases,i=r.columns,a=Object.keys(i),s=r.modifier,l=t.length;r.emit({type:"setRows",detail:e,rowCount:l,rowIndex:o,rows:t});for(let e=0,r=o,s;e<l;++e,++r)if((s=t[e])===m.NULL)for(let e=0,t=a.length;e<t;++e)i[a[e]][r]=null;else if(s instanceof Array)for(let e=0,t=a.length;e<t;++e)i[a[e]][r]=s[e];else{var u=Object.keys(s);for(let e=0,t=u.length,o;e<t;++e)o=n[o=u[e]]||o,i[o]||(i[o]=new Array(r+1)),i[o][r]=s[o]}var c=o+l;if(c>r.rowCount){r.rowCount=c;for(let e=0,t=a.length;e<t;++e)i[a[e]].length=c}this.rowKeysId&&!a.includes(this.rowKeysId)&&this.setRowKeysColumn(l),s&&s.modifyRows(r,t,o),r.emit({type:"afterSetRows",detail:e,rowCount:l,rowIndex:o,rows:t})}moveRowKeysColumnToLast(e,t){var o=e[t];delete e[t],e[t]=o}removeRowKeysColumn(e){this.rowKeysId&&-1!==e.indexOf(this.rowKeysId)&&e.pop()}}return m.NULL={},m.version="1.0.0",m}),t(e,"Data/Connectors/DataConnector.js",[e["Data/Modifiers/DataModifier.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(o,t,e){const{addEvent:r,fireEvent:s,merge:n,pick:i}=e;class a{constructor(e={}){this.table=new t(e.dataTable),this.metadata=e.metadata||{columns:{}}}get polling(){return!!this.polling}describeColumn(e,t){const o=this.metadata.columns;o[e]=n(o[e]||{},t)}describeColumns(e){const t=Object.keys(e);for(var o;"string"==typeof(o=t.pop());)this.describeColumn(o,e[o])}emit(e){s(this,e.type,e)}getColumnOrder(e){const o=this.metadata.columns,t=Object.keys(o||{});if(t.length)return t.sort((e,t)=>i(o[e].index,0)-i(o[t].index,0))}getSortedColumns(e){return this.table.getColumns(this.getColumnOrder(e))}load(){return s(this,"afterLoad",{table:this.table}),Promise.resolve(this)}on(e,t){return r(this,e,t)}save(){return s(this,"saveError",{table:this.table}),Promise.reject(new Error("Not implemented"))}setColumnOrder(o){for(let e=0,t=o.length;e<t;++e)this.describeColumn(o[e],{index:e})}setModifierOptions(e){const t=e&&o.types[e.type];return this.table.setModifier(t?new t(e):void 0).then(()=>this)}startPolling(e=1e3){const t=this;window.clearTimeout(t._polling),t._polling=window.setTimeout(()=>t.load().catch(e=>t.emit({type:"loadError",error:e,table:t.table})).then(()=>{t._polling&&t.startPolling(e)}),e)}stopPolling(){window.clearTimeout(this._polling),delete this._polling}whatIs(e){return this.metadata.columns[e]}}var l;return(l=a=a||{}).types={},l.registerType=function(e,t){return!!e&&!l.types[e]&&!!(l.types[e]=t)},a}),t(e,"Data/Converters/DataConverter.js",[e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,t){const{addEvent:o,fireEvent:r,isNumber:u,merge:s}=t;class n{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^(\d{4})([\-\.\/])(\d{1,2})\2(\d{1,2})$/,parser:function(e){return e?Date.UTC(+e[1],e[3]-1,+e[4]):NaN}},"dd/mm/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[3]-1,+e[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[1]-1,+e[3]):NaN}},"dd/mm/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){const t=new Date;if(!e)return NaN;let o=+e[4];return o>t.getFullYear()-2e3?o+=1900:o+=2e3,Date.UTC(o,e[3]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){return e?Date.UTC(+e[4]+2e3,e[1]-1,+e[3]):NaN}}};e=s(n.defaultOptions,e);let t=e.decimalPoint;"."!==t&&","!==t||(t="."===t?"\\.":",",this.decimalRegExp=new RegExp("^(-?[0-9]+)"+t+"([0-9]+)$")),this.options=e}asBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e:!!this.asNumber(e)}asDate(e){let t;if("string"==typeof e)t=this.parseDate(e);else if("number"==typeof e)t=e;else{if(e instanceof Date)return e;t=this.parseDate(this.asString(e))}return new Date(t)}asGuessedType(e){const t=this,o={number:t.asNumber,Date:t.asDate,string:t.asString};return o[t.guessType(e)].call(t,e)}asNumber(e){if("number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;if("string"!=typeof e)return e instanceof Date?e.getDate():e?e.getRowCount():NaN;{const t=this.decimalRegExp;if(-1<e.indexOf(" ")&&(e=e.replace(/\s+/g,"")),t){if(!t.test(e))return NaN;e=e.replace(t,"$1.$2")}return parseFloat(e)}}asString(e){return""+e}deduceDateFormat(e,t,o){const r=[],s=[];let n="YYYY/mm/dd",i,a=[],l=0,u=!1,c,m;for((!t||t>e.length)&&(t=e.length);l<t;l++)if(void 0!==e[l]&&e[l]&&e[l].length)for(i=e[l].trim().replace(/[\-\.\/]/g," ").split(" "),a=["","",""],m=0;m<i.length;m++)m<a.length&&(c=parseInt(i[m],10))&&(s[m]=!s[m]||s[m]<c?c:s[m],void 0!==r[m]?r[m]!==c&&(r[m]=!1):r[m]=c,31<c?a[m]=c<100?"YY":"YYYY":12<c&&c<=31?(a[m]="dd",u=!0):a[m].length||(a[m]="mm"));if(u){for(m=0;m<r.length;m++)!1!==r[m]?12<s[m]&&"YY"!==a[m]&&"YYYY"!==a[m]&&(a[m]="YY"):12<s[m]&&"mm"===a[m]&&(a[m]="dd");3===a.length&&"dd"===a[1]&&"dd"===a[2]&&(a[2]="YY"),n=a.join("/")}return o&&(this.options.dateFormat=n),n}emit(e){r(this,e.type,e)}export(e,t){throw this.emit({type:"exportError",columns:[],headers:[]}),new Error("Not implemented")}getTable(){throw new Error("Not implemented")}guessType(t){let o="string";if("string"==typeof t){const s=this.trim(""+t),n=this.decimalRegExp;let e=this.trim(s,!0);n&&(e=n.test(e)?e.replace(n,"$1.$2"):"");var r=parseFloat(e);+e===r?t=r:(r=this.parseDate(t),o=u(r)?"Date":"string")}return o="number"==typeof t?31536e6<t?"Date":"number":o}on(e,t){return o(this,e,t)}parse(e){throw this.emit({type:"parseError",columns:[],headers:[]}),new Error("Not implemented")}parseDate(e,t){const o=this,r=o.options;let s=t||r.dateFormat,n=NaN,i,a,l;if(r.parseDate)n=r.parseDate(e);else{if(s)a=(a=o.dateFormats[s])||o.dateFormats["YYYY/mm/dd"],(l=e.match(a.regex))&&(n=a.parser(l));else for(i in o.dateFormats)if(a=o.dateFormats[i],l=e.match(a.regex)){s=i,n=a.parser(l);break}l||("object"==typeof(l=Date.parse(e))&&null!==l&&l.getTime?n=l.getTime()-6e4*l.getTimezoneOffset():u(l)&&(n=l-6e4*new Date(l).getTimezoneOffset(),-1===e.indexOf("2001")&&2001===new Date(n).getFullYear()&&(n=NaN)))}return n}trim(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[\d\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e}}return n.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},(n||(n={})).getTableFromColumns=function(o=[],r=[]){const s=new e;for(let e=0,t=Math.max(r.length,o.length);e<t;++e)s.setColumn(r[e]||""+e,o[e]);return s},n}),t(e,"Data/DataCursor.js",[],function(){class f{constructor(e={}){this.emittingRegister=[],this.listenerMap={},this.stateMap=e}addListener(e,t,o){const r=this.listenerMap[e]=this.listenerMap[e]||{},s=r[t]=r[t]||[];return s.push(o),this}buildEmittingTag(e){return("position"===e.cursor.type?[e.table.id,e.cursor.column,e.cursor.row,e.cursor.state,e.cursor.type]:[e.table.id,e.cursor.columns,e.cursor.firstRow,e.cursor.lastRow,e.cursor.state,e.cursor.type]).join("\0")}emitCursor(e,t,o,r){const s=e.id,n=t.state,i=this.listenerMap[s]&&this.listenerMap[s][n];if(i){const a=this.stateMap[s]=this.stateMap[s]??{},l=a[t.state]||[],u=(r&&(l.length||(a[t.state]=l),-1===f.getIndex(t,l)&&l.push(t)),{cursor:t,cursors:l,table:e}),c=(o&&(u.event=o),this.emittingRegister),m=this.buildEmittingTag(u);if(0<=c.indexOf(m))return this;try{this.emittingRegister.push(m);for(let e=0,t=i.length;e<t;++e)i[e].call(this,u)}finally{r=this.emittingRegister.indexOf(m);0<=r&&this.emittingRegister.splice(r,1)}}return this}remitCursor(e,t){const o=this.stateMap[e]&&this.stateMap[e][t.state];return o&&0<=(e=f.getIndex(t,o))&&o.splice(e,1),this}removeListener(e,t,o){const r=this.listenerMap[e]&&this.listenerMap[e][t];return r&&0<=(e=r.indexOf(o))&&r.splice(e,1),this}}function s(e,t){if("range"===e.type)return e;const o={type:"range",firstRow:e.row??(t&&t.firstRow)??0,lastRow:e.row??(t&&t.lastRow)??Number.MAX_VALUE,state:e.state};return void 0!==e.column&&(o.columns=[e.column]),o}var e;return f.version="1.0.0",(e=f=f||{}).getIndex=function(r,s){if("position"===r.type){for(let e,t=0,o=s.length;t<o;++t)if("position"===(e=s[t]).type&&e.state===r.state&&e.column===r.column&&e.row===r.row)return t}else{var n=JSON.stringify(r.columns);for(let e,t=0,o=s.length;t<o;++t)if("range"===(e=s[t]).type&&e.state===r.state&&e.firstRow===r.firstRow&&e.lastRow===r.lastRow&&JSON.stringify(e.columns)===n)return t}return-1},e.isEqual=function(e,t){return"position"===e.type&&"position"===t.type?e.column===t.column&&e.row===t.row&&e.state===t.state:"range"===e.type&&"range"===t.type&&(e.firstRow===t.firstRow&&e.lastRow===t.lastRow&&JSON.stringify(e.columns)===JSON.stringify(t.columns))},e.isInRange=function(e,t){"position"===t.type&&(t=s(t));const o=(e="position"===e.type?s(e,t):e).columns,r=t.columns;return e.firstRow>=t.firstRow&&e.lastRow<=t.lastRow&&(!o||!r||o.every(e=>0<=r.indexOf(e)))},e.toPositions=function(t){if("position"===t.type)return[t];var r=t.columns||[];const s=[];var n=t.state;for(let o=t.firstRow,e=t.lastRow;o<e;++o)if(r.length)for(let e=0,t=r.length;e<t;++e)s.push({type:"position",column:r[e],row:o,state:n});else s.push({type:"position",row:o,state:n});return s},e.toRange=s,f}),t(e,"Data/DataPoolDefaults.js",[],function(){return{connectors:[]}}),t(e,"Data/DataPool.js",[e["Data/Connectors/DataConnector.js"],e["Data/DataPoolDefaults.js"],e["Core/Utilities.js"]],function(n,t,o){class e{constructor(e=t){e.connectors=e.connectors||[],this.connectors={},this.options=e,this.waiting={}}emit(e){o.fireEvent(this,e.type,e)}getConnector(e){var t=this.connectors[e];if(t)return Promise.resolve(t);let r=this.waiting[e];if(!r){r=this.waiting[e]=[];t=this.getConnectorOptions(e);if(!t)throw new Error(`Connector '${e}' not found.`);this.loadConnector(t).then(o=>{delete this.waiting[e];for(let e=0,t=r.length;e<t;++e)r[e][0](o)}).catch(o=>{delete this.waiting[e];for(let e=0,t=r.length;e<t;++e)r[e][1](o)})}return new Promise((e,t)=>{r.push([e,t])})}getConnectorIds(){const o=this.options.connectors,r=[];for(let e=0,t=o.length;e<t;++e)r.push(o[e].id);return r}getConnectorOptions(o){var r=this.options.connectors;for(let e=0,t=r.length;e<t;++e)if(r[e].id===o)return r[e]}getConnectorTable(e){return this.getConnector(e).then(e=>e.table)}isNewConnector(e){return!this.connectors[e]}loadConnector(s){return new Promise((t,e)=>{this.emit({type:"load",options:s});const o=n.types[s.type];if(!o)throw new Error(`Connector type not found. (${s.type})`);const r=new o(s.options);r.load().then(e=>{this.connectors[s.id]=e,this.emit({type:"afterLoad",options:s}),t(e)}).catch(e)})}on(e,t){return o.addEvent(this,e,t)}setConnectorOptions(o){const r=this.options.connectors,e=this.connectors;this.emit({type:"setConnectorOptions",options:o});for(let e=0,t=r.length;e<t;++e)if(r[e].id===o.id){r.splice(e,1);break}e[o.id]&&(e[o.id].stopPolling(),delete e[o.id]),r.push(o),this.emit({type:"afterSetConnectorOptions",options:o})}}return e.version="1.0.0",e}),t(e,"Data/Formula/FormulaParser.js",[],function(){const h=/^(?:FALSE|TRUE)/,g=/^[+\-]?\d+(?:\.\d+)?(?:e[+\-]\d+)?/,p=/^[+\-]?\d+(?:,\d+)?(?:e[+\-]\d+)?/,y=/^([A-Z][A-Z\d\.]*)\(/,b=/^(?:[+\-*\/^<=>]|<=|=>)/,u=/^(\$?[A-Z]+)(\$?\d+)\:(\$?[A-Z]+)(\$?\d+)/,c=/^R(\d*|\[\d+\])C(\d*|\[\d+\])\:R(\d*|\[\d+\])C(\d*|\[\d+\])/,C=/^(\$?[A-Z]+)(\$?\d+)(?![\:C])/,w=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!\:)/;function v(s){let n=0;for(let e=0,t=s.length,o,r=1;e<t;++e)if("("===(o=s[e]))n||(r=e+1),++n;else if(")"===o&&!--n)return s.substring(r,e);if(0<n){const e=new Error("Incomplete parantheses.");throw e.name="FormulaParseError",e}return""}function D(s){let n=-1;for(let e=0,t=s.length,o,r=!1;e<t;++e)if("\\"===(o=s[e]))r=!r;else if(r)r=!1;else if('"'===o){if(!(n<0))return s.substring(n+1,e);n=e}const e=new Error("Incomplete string.");throw e.name="FormulaParseError",e}function N(e,t){let o;if(o=e.match(c)){var r=""===o[2]||"["===o[2][0],s=""===o[1]||"["===o[1][0],n=""===o[4]||"["===o[4][0],i=""===o[3]||"["===o[3][0];const a={type:"range",beginColumn:r?parseInt(o[2].substring(1,-1)||"0",10):parseInt(o[2],10)-1,beginRow:s?parseInt(o[1].substring(1,-1)||"0",10):parseInt(o[1],10)-1,endColumn:n?parseInt(o[4].substring(1,-1)||"0",10):parseInt(o[4],10)-1,endRow:i?parseInt(o[3].substring(1,-1)||"0",10):parseInt(o[3],10)-1};return r&&(a.beginColumnRelative=!0),s&&(a.beginRowRelative=!0),n&&(a.endColumnRelative=!0),i&&(a.endRowRelative=!0),a}if(o=e.match(u)){r="$"!==o[1][0],s="$"!==o[2][0],n="$"!==o[3][0],i="$"!==o[4][0];const l={type:"range",beginColumn:F(r?o[1]:o[1].substring(1))-1,beginRow:parseInt(s?o[2]:o[2].substring(1),10)-1,endColumn:F(n?o[3]:o[3].substring(1))-1,endRow:parseInt(i?o[4]:o[4].substring(1),10)-1};return r&&(l.beginColumnRelative=!0),s&&(l.beginRowRelative=!0),n&&(l.endColumnRelative=!0),i&&(l.endRowRelative=!0),l}r=R(e,t);return 1===r.length&&"string"!=typeof r[0]?r[0]:r}function R(e,t){const o=t?p:g,r=[];let s,n=("="===e[0]?e.substring(1):e).trim();for(;n;)if(s=n.match(w)){var i=""===s[2]||"["===s[2][0],a=""===s[1]||"["===s[1][0];const u={type:"reference",column:i?parseInt(s[2].substring(1,-1)||"0",10):parseInt(s[2],10)-1,row:a?parseInt(s[1].substring(1,-1)||"0",10):parseInt(s[1],10)-1};i&&(u.columnRelative=!0),a&&(u.rowRelative=!0),r.push(u),n=n.substring(s[0].length).trim()}else if(s=n.match(C)){i="$"!==s[1][0],a="$"!==s[2][0];const c={type:"reference",column:F(i?s[1]:s[1].substring(1))-1,row:parseInt(a?s[2]:s[2].substring(1),10)-1};i&&(c.columnRelative=!0),a&&(c.rowRelative=!0),r.push(c),n=n.substring(s[0].length).trim()}else if(s=n.match(b))r.push(s[0]),n=n.substring(s[0].length).trim();else if(s=n.match(h))r.push("TRUE"===s[0]),n=n.substring(s[0].length).trim();else if(s=n.match(o))r.push(parseFloat(s[0])),n=n.substring(s[0].length).trim();else if('"'===n[0]){const m=D(n);r.push(m.substring(1,-1)),n=n.substring(m.length+2).trim()}else{if(!(s=n.match(y))){if("("===n[0]){var l=v(n);if(l){r.push(R(l,t)),n=n.substring(l.length+2).trim();continue}}const f=e.length-n.length,d=new Error("Unexpected character `"+e.substring(f,1+f)+"` at position "+(1+f)+". (`..."+e.substring(f-5,6+f)+"...`)");throw d.name="FormulaParseError",d}l=v(n=n.substring(s[1].length).trim());r.push({type:"function",name:s[1],args:function(r,s){const n=[],i=s?";":",";let a=0,l="";for(let e=0,t=r.length,o;e<t;++e){var u;(o=r[e])===i&&!a&&l?(n.push(N(l,s)),l=""):'"'!==o||a||l?" "!==o&&(l+=o,"("===o?++a:")"===o&&--a):(u=D(r.substring(e)),n.push(u),e+=u.length+1)}return!a&&l&&n.push(N(l,s)),n}(l,t)}),n=n.substring(l.length+2).trim()}return r}function F(s){let n=0;for(let e=0,t=s.length,o,r=s.length-1;e<t;++e)65<=(o=s.charCodeAt(e))&&o<=90&&(n+=(o-64)*Math.pow(26,r)),--r;return n}return{parseFormula:R}}),t(e,"Data/Formula/FormulaTypes.js",[],function(){const t=["+","-","*","/","^","=","<","<=",">",">="];return{isFormula:function(e){return e instanceof Array},isFunction:function(e){return"object"==typeof e&&!(e instanceof Array)&&"function"===e.type},isOperator:function(e){return"string"==typeof e&&0<=t.indexOf(e)},isRange:function(e){return"object"==typeof e&&!(e instanceof Array)&&"range"===e.type},isReference:function(e){return"object"==typeof e&&!(e instanceof Array)&&"reference"===e.type},isValue:function(e){return"boolean"==typeof e||"number"==typeof e||"string"==typeof e}}}),t(e,"Data/Formula/FormulaProcessor.js",[e["Data/Formula/FormulaTypes.js"]],function(e){const{isFormula:c,isFunction:m,isOperator:f,isRange:a,isReference:d,isValue:h}=e,t=/ */,o=Number.MAX_VALUE/1.000000000001,r=Number.MAX_VALUE/1.000000000002,s=Number.MAX_VALUE,g={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},n={},i=/^[A-Z][A-Z\.]*$/;function l(e){switch(typeof e){case"boolean":return e?s:o;case"string":return r;case"number":return e;default:return NaN}}function u(e){return"string"==typeof e?e.toLowerCase().replace(t,"\0"):e}function p(e){switch(typeof e){case"boolean":return e?1:0;case"string":return parseFloat(e.replace(",","."));case"number":return e;default:return NaN}}function y(e,t,o){switch(e){case"=":return u(t)===u(o);case"<":return typeof t==typeof o?u(t)<u(o):l(t)<l(o);case"<=":return typeof t==typeof o?u(t)<=u(o):l(t)<=l(o);case">":return typeof t==typeof o?u(t)>u(o):l(t)>l(o);case">=":return typeof t==typeof o?u(t)>=u(o):l(t)>=l(o)}t=p(t),o=p(o);let r;switch(e){case"+":r=t+o;break;case"-":r=t-o;break;case"*":r=t*o;break;case"/":r=t/o;break;case"^":r=Math.pow(t,o);break;default:return NaN}return r%1?Math.round(1e9*r)/1e9:r}function b(e,t){return h(e)?e:a(e)?t&&C(e,t)||[]:m(e)?D(e,t):v(c(e)?e:[e],t)}function C(s,n){const i=n.getColumnNames().slice(s.beginColumn,s.endColumn+1),a=[];for(let o=0,e=i.length,r;o<e;++o){var l=n.getColumn(i[o],!0)||[];for(let e=s.beginRow,t=s.endRow+1;e<t;++e)"string"==typeof(r=l[e])&&"="===r[0]&&n!==n.modified&&(r=n.modified.getCell(i[o],e)),a.push(h(r)?r:NaN)}return a}function w(e,t){var o,r=t.getColumnNames()[e.column];return r?"string"==typeof(o=t.getCell(r,e.row))&&"="===o[0]&&t!==t.modified?(t=t.modified.getCell(r,e.row),h(t)?t:NaN):h(o)?o:NaN:NaN}function v(i,a){let l;for(let e=0,t=i.length,o,r,s,n;e<t;++e)if(o=i[e],f(o))r=o;else if(h(o)?n=o:c(o)?n=v(i,a):m(o)?(s=D(o,a),n=h(s)?s:NaN):d(o)&&(n=a&&w(o,a)),void 0!==n){if(void 0===l)l=r?y(r,0,n):n;else{if(!r)return NaN;var u=i[e+1];f(u)&&g[u]>g[r]&&(n=y(u,n,v(i.slice(e+2))),e=t),l=y(r,l,n)}r=void 0,n=void 0}return h(l)?l:NaN}function D(e,t){const o=n[e.name];if(o)try{return o(e.args,t)}catch{return NaN}const r=new Error(`Function "${e.name}" not found.`);throw r.name="FormulaProcessError",r}return{asNumber:p,getArgumentValue:b,getArgumentsValues:function(o,r){const s=[];for(let e=0,t=o.length;e<t;++e)s.push(b(o[e],r));return s},getRangeValues:C,getReferenceValue:w,processFormula:v,processorFunctions:n,registerProcessorFunction:function(e,t){return i.test(e)&&!n[e]&&!!(n[e]=t)},translateReferences:function r(s,n=0,i=0){for(let e=0,t=s.length,o;e<t;++e)(o=s[e])instanceof Array?r(o,n,i):m(o)?r(o.args,n,i):a(o)?(o.beginColumnRelative&&(o.beginColumn+=n),o.beginRowRelative&&(o.beginRow+=i),o.endColumnRelative&&(o.endColumn+=n),o.endRowRelative&&(o.endRow+=i)):d(o)&&(o.columnRelative&&(o.column+=n),o.rowRelative&&(o.row+=i));return s}}}),t(e,"Data/Formula/Functions/ABS.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const o=e["getArgumentValue"];function t(e,t){var r=o(e[0],t);switch(typeof r){case"number":return Math.abs(r);case"object":{const s=[];for(let e=0,t=r.length,o;e<t;++e){if("number"!=typeof(o=r[e]))return NaN;s.push(Math.abs(o))}return s}default:return NaN}}return e.registerProcessorFunction("ABS",t),t}),t(e,"Data/Formula/Functions/AND.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const n=e["getArgumentValue"];function i(r,s){for(let e=0,t=r.length,o;e<t;++e)if(!(o=n(r[e],s))||"object"==typeof o&&!i(o,s))return!1;return!0}return e.registerProcessorFunction("AND",i),i}),t(e,"Data/Formula/Functions/AVERAGE.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const r=e["getArgumentsValues"];function t(e,t){var o=r(e,t);let s=0,n=0;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":isNaN(r)||(++s,n+=r);break;case"object":for(let e=0,t=r.length,o;e<t;++e)"number"!=typeof(o=r[e])||isNaN(o)||(++s,n+=o)}return s?n/s:0}return e.registerProcessorFunction("AVERAGE",t),t}),t(e,"Data/Formula/Functions/AVERAGEA.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const a=e["getArgumentValue"];function t(o,s){let n=0,i=0;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=a(o[e],s))){case"boolean":++n,i+=r?1:0;continue;case"number":isNaN(r)||(++n,i+=r);continue;case"string":++n;continue;default:for(let e=0,t=r.length,o;e<t;++e)switch(typeof(o=r[e])){case"boolean":++n,i+=o?1:0;continue;case"number":isNaN(o)||(++n,i+=o);continue;case"string":++n;continue}continue}return n?i/n:0}return e.registerProcessorFunction("AVERAGEA",t),t}),t(e,"Data/Formula/Functions/COUNT.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){function i(e,r){var s=t.getArgumentsValues(e,r);let n=0;for(let e=0,t=s.length,o;e<t;++e)switch(typeof(o=s[e])){case"number":isNaN(o)||++n;break;case"object":n+=i(o,r)}return n}return t.registerProcessorFunction("COUNT",i),i}),t(e,"Data/Formula/Functions/COUNTA.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){function i(e,r){var s=t.getArgumentsValues(e,r);let n=0;for(let e=0,t=s.length,o;e<t;++e){switch(typeof(o=s[e])){case"number":if(isNaN(o))continue;break;case"object":n+=i(o,r);continue;case"string":if(o)break;continue}++n}return n}return t.registerProcessorFunction("COUNTA",i),i}),t(e,"Data/Formula/Functions/IF.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const o=e["getArgumentValue"];function t(e,t){return o(e[0],t)?o(e[1],t):o(e[2],t)}return e.registerProcessorFunction("IF",t),t}),t(e,"Data/Formula/Functions/ISNA.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const o=e["getArgumentValue"];function t(e,t){e=o(e[0],t);return"number"!=typeof e||isNaN(e)}return e.registerProcessorFunction("ISNA",t),t}),t(e,"Data/Formula/Functions/MAX.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const o=e["getArgumentsValues"];function n(e,t){var r=o(e,t);let s=Number.NEGATIVE_INFINITY;for(let e=0,t=r.length,o;e<t;++e)switch(typeof(o=r[e])){case"number":o>s&&(s=o);break;case"object":(o=n(o))>s&&(s=o)}return isFinite(s)?s:0}return e.registerProcessorFunction("MAX",n),n}),t(e,"Data/Formula/Functions/MEDIAN.js",[e["Data/Formula/FormulaProcessor.js"]],function(r){function e(e,t){const s=[],o=r.getArgumentsValues(e,t);for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":isNaN(r)||s.push(r);break;case"object":for(let e=0,t=r.length,o;e<t;++e)"number"!=typeof(o=r[e])||isNaN(o)||s.push(o)}e=s.length;if(!e)return NaN;t=Math.floor(e/2);return e%2?s[t]:(s[t-1]+s[t])/2}return r.registerProcessorFunction("MEDIAN",e),e}),t(e,"Data/Formula/Functions/MIN.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const o=e["getArgumentsValues"];function n(e,t){var r=o(e,t);let s=Number.POSITIVE_INFINITY;for(let e=0,t=r.length,o;e<t;++e)switch(typeof(o=r[e])){case"number":o<s&&(s=o);break;case"object":(o=n(o))<s&&(s=o)}return isFinite(s)?s:0}return e.registerProcessorFunction("MIN",n),n}),t(e,"Data/Formula/Functions/MOD.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const s=e["getArgumentValue"];function t(e,t){let o=s(e[0],t),r=s(e[1],t);return"object"==typeof o&&(o=o[0]),"object"==typeof r&&(r=r[0]),"number"!=typeof o||"number"!=typeof r||0===r?NaN:o%r}return e.registerProcessorFunction("MOD",t),t}),t(e,"Data/Formula/Functions/MODE.js",[e["Data/Formula/FormulaProcessor.js"]],function(r){function o(e,t){const s={},o=r.getArgumentsValues(e,t);for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":isNaN(r)||(s[r]=(s[r]||0)+1);break;case"object":for(let e=0,t=r.length,o;e<t;++e)"number"!=typeof(o=r[e])||isNaN(o)||(s[o]=(s[o]||0)+1)}return s}function e(e,t){var s=o(e,t),n=Object.keys(s);if(!n.length)return NaN;let i=[parseFloat(n[0])],a=s[n[0]];for(let e=1,t=n.length,o,r;e<t;++e)r=s[o=n[e]],a<r?(i=[parseFloat(o)],a=r):a===r&&i.push(parseFloat(o));return 1<a?i:NaN}function t(e,t){var n=o(e,t),i=Object.keys(n);if(!i.length)return NaN;let a=parseFloat(i[0]),l=n[i[0]];for(let e=1,t=i.length,o,r,s;e<t;++e)s=n[o=i[e]],l<s?(a=parseFloat(o),l=s):l===s&&(r=parseFloat(o),a>r&&(a=r,l=s));return 1<l?a:NaN}return r.registerProcessorFunction("MODE",t),r.registerProcessorFunction("MODE.MULT",e),r.registerProcessorFunction("MODE.SNGL",t),{MULT:e,SNGL:t}}),t(e,"Data/Formula/Functions/NOT.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const r=e["getArgumentValue"];function t(e,t){let o=r(e[0],t);switch(typeof(o="object"==typeof o?o[0]:o)){case"boolean":case"number":return!o}return NaN}return e.registerProcessorFunction("NOT",t),t}),t(e,"Data/Formula/Functions/OR.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const n=e["getArgumentValue"];function i(r,s){for(let e=0,t=r.length,o;e<t;++e)if("object"==typeof(o=n(r[e],s))){if(i(o,s))return!0}else if(o)return!0;return!1}return e.registerProcessorFunction("OR",i),i}),t(e,"Data/Formula/Functions/PRODUCT.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const t=e["getArgumentsValues"];function a(e,r){var s=t(e,r);let n=1,i=!1;for(let e=0,t=s.length,o;e<t;++e)switch(typeof(o=s[e])){case"number":isNaN(o)||(i=!0,n*=o);break;case"object":i=!0,n*=a(o,r)}return i?n:0}return e.registerProcessorFunction("PRODUCT",a),a}),t(e,"Data/Formula/Functions/SUM.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){function i(e,r){var s=t.getArgumentsValues(e,r);let n=0;for(let e=0,t=s.length,o;e<t;++e)switch(typeof(o=s[e])){case"number":isNaN(o)||(n+=o);break;case"object":n+=i(o,r)}return n}return t.registerProcessorFunction("SUM",i),i}),t(e,"Data/Formula/Functions/XOR.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){const i=e["getArgumentValue"];function t(o,n){for(let e=0,t=o.length,r,s;e<t;++e)switch(typeof(s=i(o[e],n))){case"boolean":case"number":if(void 0===r)r=!!s;else if(!!s!==r)return!0;break;case"object":for(let e=0,t=s.length,o;e<t;++e)switch(typeof(o=s[e])){case"boolean":case"number":if(void 0===r)r=!!o;else if(!!o!==r)return!0}}return!1}return e.registerProcessorFunction("XOR",t),t}),t(e,"Data/Formula/Formula.js",[e["Data/Formula/FormulaParser.js"],e["Data/Formula/FormulaProcessor.js"],e["Data/Formula/FormulaTypes.js"]],function(e,t,o){return{...e,...t,...o}}),t(e,"Data/Converters/CSVConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,t){const p=t["merge"];class o extends e{constructor(e){e=p(o.defaultOptions,e);super(e),this.columns=[],this.headers=[],this.dataTypes=[],this.options=e}export(e,t=this.options){var{useLocalDecimalPoint:o,lineDelimiter:r}=t,s=!1!==this.options.firstRowAsNames;let{decimalPoint:n,itemDelimiter:i}=t;n=n||(","!==i&&o?1.1.toLocaleString()[1]:"."),i=i||(","===n?";":",");const a=e.getSortedColumns(t.usePresentationOrder),l=Object.keys(a),u=[],c=l.length,m=[];s&&u.push(l.map(e=>`"${e}"`).join(i));for(let r=0;r<c;r++){var f=l[r],d=a[f],h=d.length,f=e.whatIs(f);let o;f&&(o=f.dataType);for(let t=0;t<h;t++){let e=d[t];if(m[t]||(m[t]=[]),"string"===o?e='"'+e+'"':"number"==typeof e?e=String(e).replace(".",n):"string"==typeof e&&(e=`"${e}"`),m[t][r]=e,r===c-1){let e=r;for(;2<m[t].length;){if(void 0!==m[t][e])break;m[t].pop(),e--}u.push(m[t].join(i))}}}return u.join(r)}parse(e,t){const r=this,o=r.dataTypes,s=p(this.options,e),{beforeParse:n,lineDelimiter:i,firstRowAsNames:a,itemDelimiter:l}=s;let u,c=0,{csv:m,startRow:f,endRow:d}=s,h;if(r.columns=[],r.emit({type:"parse",columns:r.columns,detail:t,headers:r.headers}),m=m&&n?n(m):m){if(u=m.replace(/\r\n|\r/g,"\n").split(i||"\n"),(!f||f<0)&&(f=0),(!d||d>=u.length)&&(d=u.length-1),l||(r.guessedItemDelimiter=r.guessDelimiter(u)),a){const g=u[0].split(l||r.guessedItemDelimiter||",");for(let e=0;e<g.length;e++)g[e]=g[e].trim().replace(/^["']|["']$/g,"");r.headers=g,f++}let e=0;for(c=f;c<=d;c++)"#"===u[c][0]?e++:r.parseCSVRow(u[c],c-f-e);o.length&&o[0].length&&"date"===o[0][1]&&!r.options.dateFormat&&r.deduceDateFormat(r.columns[0],null,!0);for(let o=0,e=r.columns.length;o<e;++o)for(let t=0,e=(h=r.columns[o]).length;t<e;++t)if(h[t]&&"string"==typeof h[t]){let e=r.asGuessedType(h[t]);e instanceof Date&&(e=e.getTime()),r.columns[o][t]=e}}r.emit({type:"afterParse",columns:r.columns,detail:t,headers:r.headers})}parseCSVRow(t,o){const r=this,s=r.columns||[],n=r.dataTypes,{startColumn:i,endColumn:a}=r.options,e=r.options.itemDelimiter||r.guessedItemDelimiter;let l=r.options["decimalPoint"],u=(l&&l!==e||(l=r.guessedDecimalPoint||"."),0),c="",m="",f=0,d=0;var h=e=>{c=t[e]};const g=e=>{n.length<d+1&&n.push([e]),n[d][n[d].length-1]!==e&&n[d].push(e)};var p=()=>{if(i>f||f>a)return++f,void(m="");var e;"string"==typeof m?!isNaN(parseFloat(m))&&isFinite(m)?(m=parseFloat(m),g("number")):isNaN(Date.parse(m))?g("string"):(m=m.replace(/\//g,"-"),g("date")):g("number"),s.length<d+1&&s.push([]),"number"!=typeof m&&"number"!==r.guessType(m)&&l&&(m=(e=m).replace(l,"."),"number"!==r.guessType(m)&&(m=e)),s[d][o]=m,m="",++d,++f};if(t.trim().length&&"#"!==t.trim()[0]){for(;u<t.length;u++){if(h(u),"#"===c&&!/^#[A-F\d]{3,3}|[A-F\d]{6,6}/i.test(t.substring(u)))return void p();if('"'===c)for(h(++u);u<t.length&&'"'!==c;)m+=c,h(++u);else c===e?p():m+=c}p()}}guessDelimiter(i){let a=0,l=0,e;const u={",":0,";":0,"\t":0},t=i.length;for(let e=0;e<t;e++){let t=!1,o,r,s,n="";if(13<e)break;var c=i[e];for(let e=0;e<c.length&&(o=c[e],r=c[e+1],s=c[e-1],"#"!==o);e++){if('"'===o)if(t){if('"'!==s&&'"'!==r){for(;" "===r&&e<c.length;)r=c[++e];void 0!==u[r]&&u[r]++,t=!1}}else t=!0;else void 0!==u[o]?(n=n.trim(),isNaN(Date.parse(n))&&!isNaN(Number(n))&&isFinite(Number(n))||u[o]++,n=""):n+=o;","===o&&l++,"."===o&&a++}}return e=u[";"]>u[","]?";":(u[","],u[";"],","),a>l?this.guessedDecimalPoint=".":this.guessedDecimalPoint=",",e}getTable(){return e.getTableFromColumns(this.columns,this.headers)}}return o.defaultOptions={...e.defaultOptions,lineDelimiter:"\n"},o}),t(e,"Data/Connectors/CSVConnector.js",[e["Data/Converters/CSVConverter.js"],e["Data/Connectors/DataConnector.js"],e["Core/Utilities.js"]],function(t,e,o){const r=o["merge"];class s extends e{constructor(e){e=r(s.defaultOptions,e);super(e),this.converter=new t(e),(this.options=e).enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){const o=this,r=o.converter,s=o.table,{csv:e,csvURL:n,dataModifier:i}=o.options;return o.emit({type:"load",csv:e,detail:t,table:s}),Promise.resolve(n?fetch(n).then(e=>e.text()):e||"").then(e=>(e&&(s.deleteColumns(),r.parse({csv:e}),s.setColumns(r.getTable().getColumns())),o.setModifierOptions(i).then(()=>e))).then(e=>(o.emit({type:"afterLoad",csv:e,detail:t,table:s}),o)).catch(e=>{throw o.emit({type:"loadError",detail:t,error:e,table:s}),e})}}return s.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0},e.registerType("CSV",s),s}),t(e,"Data/Converters/JSONConverter.js",[e["Data/Converters/DataConverter.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,t,o){const{error:c,isArray:m,merge:f,objectEach:d}=o;class r extends e{constructor(e){e=f(r.defaultOptions,e);super(e),this.columns=[],this.headers=[],this.options=e,this.table=new t}parse(e,t){var r=this;const{beforeParse:o,orientation:s,firstRowAsNames:n,columnNames:i}=e=f(r.options,e);let a=e.data;if(a){if(r.columns=[],r.emit({type:"parse",columns:r.columns,detail:t,headers:r.headers}),a=(a=o?o(a):a).slice(),"columns"===s)for(let e=0,t=a.length;e<t;e++){const l=a[e];if(!(l instanceof Array))return;r.headers instanceof Array?(n?r.headers.push(""+l.shift()):i&&i instanceof Array&&r.headers.push(i[e]),r.table.setColumn(r.headers[e]||e.toString(),l)):c("JSONConverter: Invalid `columnNames` option.",!1)}else if("rows"===s){n?r.headers=a.shift():i&&(r.headers=i);for(let e=0,t=a.length;e<t;e++){let o=a[e];if(m(o))for(let e=0,t=o.length;e<t;e++)r.columns.length<e+1&&r.columns.push([]),r.columns[e].push(o[e]),r.headers instanceof Array?this.table.setColumn(r.headers[e]||e.toString(),r.columns[e]):c("JSONConverter: Invalid `columnNames` option.",!1);else{const i=r.headers;if(i&&!(i instanceof Array)){const u={};d(i,(e,t)=>{u[t]=e.reduce((e,t)=>e[t],o)}),o=u}this.table.setRows([o],e)}}}r.emit({type:"afterParse",columns:r.columns,detail:t,headers:r.headers})}}getTable(){return this.table}}return r.defaultOptions={...e.defaultOptions,data:[],orientation:"rows"},r}),t(e,"Data/Connectors/JSONConnector.js",[e["Data/Connectors/DataConnector.js"],e["Core/Utilities.js"],e["Data/Converters/JSONConverter.js"]],function(e,t,o){const r=t["merge"];class s extends e{constructor(e){e=r(s.defaultOptions,e);super(e),this.converter=new o(e),(this.options=e).enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){const o=this,r=o.converter,s=o.table,{data:e,dataUrl:n,dataModifier:i}=o.options;return o.emit({type:"load",data:e,detail:t,table:s}),Promise.resolve(n?fetch(n).then(e=>e.json()):e||[]).then(e=>(e&&(s.deleteColumns(),r.parse({data:e}),s.setColumns(r.getTable().getColumns()),s.setRowKeysColumn(e.length)),o.setModifierOptions(i).then(()=>e))).then(e=>(o.emit({type:"afterLoad",data:e,detail:t,table:s}),o)).catch(e=>{throw o.emit({type:"loadError",detail:t,error:e,table:s}),e})}}return s.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},e.registerType("JSON",s),s}),t(e,"Data/Converters/GoogleSheetsConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,t){const{merge:l,uniqueKey:u}=t;class o extends e{constructor(e){e=l(o.defaultOptions,e);super(e),this.columns=[],this.header=[],this.options=e}parse(e,t){const r=this,s=l(r.options,e);let n=(s.json?.values||[]).map(e=>e.slice());if(0===n.length)return!1;r.header=[],r.columns=[],r.emit({type:"parse",columns:r.columns,detail:t,headers:r.header});const{beforeParse:o,json:i}=s;o&&i&&(n=o(i.values));let a;for(let o=0,e=(r.columns=n).length;o<e;o++){a=n[o],r.header[o]=s.firstRowAsNames?""+a.shift():u();for(let t=0,e=a.length;t<e;++t)if(a[t]&&"string"==typeof a[t]){let e=r.asGuessedType(a[t]);e instanceof Date&&(e=e.getTime()),r.columns[o][t]=e}}r.emit({type:"afterParse",columns:r.columns,detail:t,headers:r.header})}getTable(){return e.getTableFromColumns(this.columns,this.header)}}return o.defaultOptions={...e.defaultOptions},o}),t(e,"Data/Connectors/GoogleSheetsConnector.js",[e["Data/Connectors/DataConnector.js"],e["Data/Converters/GoogleSheetsConverter.js"],e["Core/Utilities.js"]],function(e,t,o){const{merge:r,pick:n}=o;class m extends e{constructor(e){e=r(m.defaultOptions,e);super(e),this.converter=new t(e),this.options=e}load(t){const o=this,r=o.converter,s=o.table,{dataModifier:n,dataRefreshRate:e,enablePolling:i,firstRowAsNames:a,googleAPIKey:l,googleSpreadsheetKey:u}=o.options,c=m.buildFetchURL(l,u,o.options);return o.emit({type:"load",detail:t,table:s,url:c}),fetch(c).then(e=>e.json()).then(e=>{if("object"==typeof(t=e)&&t&&"object"==typeof t.error&&t.error&&"number"==typeof t.error.code&&"string"==typeof t.error.message&&"string"==typeof t.error.status)throw new Error(e.error.message);var t;return r.parse({firstRowAsNames:a,json:e}),s.deleteColumns(),s.setColumns(r.getTable().getColumns()),o.setModifierOptions(n)}).then(()=>(o.emit({type:"afterLoad",detail:t,table:s,url:c}),i&&setTimeout(()=>o.load(),1e3*Math.max(e||0,1)),o)).catch(e=>{throw o.emit({type:"loadError",detail:t,error:e,table:s}),e})}}m.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",worksheet:1,enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0};{o=m=m||{};const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function s(e={}){var{endColumn:e,endRow:t,googleSpreadsheetRange:o,startColumn:r,startRow:s}=e;return o||(i[r||0]||"A")+(Math.max(s||0,0)+1)+":"+(i[n(e,25)]||"Z")+(t?Math.max(t,0):"Z")}o.buildFetchURL=function(e,t,o={}){return`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/`+(o.onlyColumnNames?"A1:Z1":s(o))+"?alt=json"+(o.onlyColumnNames?"":"&dateTimeRenderOption=FORMATTED_STRING&majorDimension=COLUMNS&valueRenderOption=UNFORMATTED_VALUE")+"&prettyPrint=false&key="+e},o.buildQueryRange=s}return e.registerType("GoogleSheets",m),m}),t(e,"Data/Converters/HTMLTableConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,t){const o=t["merge"];class r extends e{constructor(e){e=o(r.defaultOptions,e);super(e),this.columns=[],this.headers=[],(this.options=e).tableElement&&(this.tableElement=e.tableElement,this.tableElementID=e.tableElement.id)}export(e,t=this.options){var o=!1!==t.firstRowAsNames,r=t.useMultiLevelHeaders;const s=e.getSortedColumns(t.usePresentationOrder),n=Object.keys(s),i=[],a=n.length,l=[];let u="";if(o){const g=[];if(r){for(const p of n){var c=(s[p].shift()||"").toString();g.push(c)}u=this.getTableHeaderHTML(n,g,t)}else u=this.getTableHeaderHTML(void 0,n,t)}for(let o=0;o<a;o++){var m=n[o],f=s[m],d=f.length;for(let t=0;t<d;t++){let e=f[t];l[t]||(l[t]=[]),"string"!=typeof e&&"number"!=typeof e&&void 0!==e&&(e=(e||"").toString()),l[t][o]=this.getCellHTMLFromValue(o?"td":"th",null,o?"":'scope="row"',e),o===a-1&&i.push("<tr>"+l[t].join("")+"</tr>")}}let h="";return"<table>"+(h=t.tableCaption?'<caption class="highcharts-table-caption">'+t.tableCaption+"</caption>":h)+u+"<tbody>"+i.join("")+"</tbody></table>"}getCellHTMLFromValue(e,t,o,r,s){let n=r,i="text"+(t?" "+t:"");return"number"==typeof n?(n=n.toString(),","===s&&(n=n.replace(".",s)),i="number"):r||(n="",i="empty"),"<"+e+(o?" "+o:"")+' class="'+i+'">'+n+"</"+e+">"}getTableHeaderHTML(e=[],t=[],o=this.options){var{useMultiLevelHeaders:o,useRowspanHeaders:r}=o;let s="<thead>",n=0,i=t&&t.length,a,l=0,u;if(o&&e&&t&&!function(e,t){let o=e.length;if(t.length===o){for(;--o;)if(e[o]!==t[o])return;return 1}}(e,t)){for(s+="<tr>";n<i;++n)(a=e[n])===e[n+1]?++l:l?(s+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(l+1)+'"',a),l=0):(a===t[n]?r?(u=2,delete t[n]):(u=1,t[n]=""):u=1,s+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(1<u?' valign="top" rowspan="'+u+'"':""),a));s+="</tr>"}if(t){for(s+="<tr>",n=0,i=t.length;n<i;++n)void 0!==t[n]&&(s+=this.getCellHTMLFromValue("th",null,'scope="col"',t[n]));s+="</tr>"}return s+="</thead>"}parse(e,t){const n=this,i=[],a=[],l=o(n.options,e),{endRow:u,startColumn:c,endColumn:m,firstRowAsNames:f}=l,d=l.tableElement||this.tableElement;if(d instanceof HTMLElement){n.tableElement=d,n.tableElementID=d.id,this.emit({type:"parse",columns:n.columns,detail:t,headers:n.headers});var h=d.getElementsByTagName("tr"),g=h.length;let o=0,r,s=l["startRow"];if(f&&g){var p=h[0].children,y=p.length;for(let e=c;e<y&&!(e>m);e++)"TD"!==(r=p[e]).tagName&&"TH"!==r.tagName||a.push(r.innerHTML);s++}for(;o<g;){if(o>=s&&o<=u){var b=h[o].children,C=b.length;let e=0;for(;e<C;){const w=e-c,v=i[w];if(("TD"===(r=b[e]).tagName||"TH"===r.tagName)&&e>=c&&e<=m){i[w]||(i[w]=[]);let e=n.asGuessedType(r.innerHTML),t=(e instanceof Date&&(e=e.getTime()),i[w][o-s]=e,1);for(;o-s>=t&&void 0===v[o-s-t];)v[o-s-t]=null,t++}e++}}o++}this.columns=i,this.headers=a,this.emit({type:"afterParse",columns:i,detail:t,headers:a})}else n.emit({type:"parseError",columns:i,detail:t,headers:a,error:"Not a valid HTML Table"})}getTable(){return e.getTableFromColumns(this.columns,this.headers)}}return r.defaultOptions={...e.defaultOptions,useRowspanHeaders:!0,useMultiLevelHeaders:!0},r}),t(e,"Data/Connectors/HTMLTableConnector.js",[e["Data/Connectors/DataConnector.js"],e["Core/Globals.js"],e["Data/Converters/HTMLTableConverter.js"],e["Core/Utilities.js"]],function(e,t,o,r){const l=t["win"],u=r["merge"];class s extends e{constructor(e){e=u(s.defaultOptions,e);super(e),this.converter=new o(e),this.options=e}load(e){const t=this,o=t.converter,r=t.table,{dataModifier:s,table:n}=t.options;t.emit({type:"load",detail:e,table:r,tableElement:t.tableElement});let i;var a;return"string"==typeof n?(t.tableID=n,i=l.document.getElementById(n)):(i=n,t.tableID=i.id),t.tableElement=i||void 0,t.tableElement?(o.parse(u({tableElement:t.tableElement},t.options),e),r.deleteColumns(),r.setColumns(o.getTable().getColumns()),t.setModifierOptions(s).then(()=>(t.emit({type:"afterLoad",detail:e,table:r,tableElement:t.tableElement}),t))):(t.emit({type:"loadError",detail:e,error:a="HTML table not provided, or element with ID not found",table:r}),Promise.reject(new Error(a)))}}return s.defaultOptions={table:""},e.registerType("HTMLTable",s),s}),t(e,"Data/Modifiers/ChainModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(i,e){const t=e["merge"];class o extends i{constructor(e,...s){super(),this.chain=s,this.options=t(o.defaultOptions,e);var n=this.options.chain||[];for(let e=0,t=n.length,o,r;e<t;++e)(o=n[e]).type&&(r=i.types[o.type])&&s.push(new r(o))}add(e,t){this.emit({type:"addModifier",detail:t,modifier:e}),this.chain.push(e),this.emit({type:"addModifier",detail:t,modifier:e})}clear(e){this.emit({type:"clearChain",detail:e}),this.chain.length=0,this.emit({type:"afterClearChain",detail:e})}modify(t,o){var r=this.options.reverse?this.chain.slice().reverse():this.chain.slice();t.modified===t&&(t.modified=t.clone(!1,o));let s=Promise.resolve(t);for(let e=0,t=r.length;e<t;++e){const n=r[e];s=s.then(e=>n.modify(e.modified,o))}return s=(s=s.then(e=>(t.modified.deleteColumns(),t.modified.setColumns(e.modified.getColumns()),t))).catch(e=>{throw this.emit({type:"error",detail:o,table:t}),e})}modifyCell(e,r,s,n,i){const a=this.options.reverse?this.chain.reverse():this.chain;if(a.length){let o=e.clone();for(let e=0,t=a.length;e<t;++e)a[e].modifyCell(o,r,s,n,i),o=o.modified;e.modified=o}return e}modifyColumns(e,r,s,n){const i=this.options.reverse?this.chain.reverse():this.chain.slice();if(i.length){let o=e.clone();for(let e=0,t=i.length;e<t;++e)i[e].modifyColumns(o,r,s,n),o=o.modified;e.modified=o}return e}modifyRows(e,r,s,n){const i=this.options.reverse?this.chain.reverse():this.chain.slice();if(i.length){let o=e.clone();for(let e=0,t=i.length;e<t;++e)i[e].modifyRows(o,r,s,n),o=o.modified;e.modified=o}return e}modifyTable(e,r){var t=this,s=(t.emit({type:"modify",detail:r,table:e}),t.options.reverse?t.chain.reverse():t.chain.slice());let n=e.modified;for(let e=0,t=s.length,o;e<t;++e)o=s[e],n=o.modifyTable(n,r).modified;return e.modified=n,t.emit({type:"afterModify",detail:r,table:e}),e}remove(e,t){const o=this.chain;this.emit({type:"removeModifier",detail:t,modifier:e}),o.splice(o.indexOf(e),1),this.emit({type:"afterRemoveModifier",detail:t,modifier:e})}}return o.defaultOptions={type:"Chain"},i.registerType("Chain",o),o}),t(e,"Data/Modifiers/InvertModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(e,t){const o=t["merge"];class r extends e{constructor(e){super(),this.options=o(r.defaultOptions,e)}modifyCell(e,t,o,r,s){const n=e.modified,i=n.getRowIndexBy("columnNames",t);return void 0===i?n.setColumns(this.modifyTable(e.clone()).getColumns(),void 0,s):n.setCell(""+o,i,r,s),e}modifyColumns(e,n,i,a){const l=e.modified,o=l.getColumn("columnNames")||[];let u=e.getColumnNames(),r=e.getRowCount()!==o.length;if(!r)for(let e=0,t=u.length;e<t;++e)if(u[e]!==o[e]){r=!0;break}if(r)return this.modifyTable(e,a);for(let e=0,t=(u=Object.keys(n)).length,r,o,s;e<t;++e){r=n[o=u[e]],s=l.getRowIndexBy("columnNames",o)||l.getRowCount();for(let e=0,t=i,o=r.length;e<o;++e,++t)l.setCell(""+t,s,r[e],a)}return e}modifyRows(e,s,n,i){const a=e.getColumnNames(),l=e.modified,o=l.getColumn("columnNames")||[];let r=e.getRowCount()!==o.length;if(!r)for(let e=0,t=a.length;e<t;++e)if(a[e]!==o[e]){r=!0;break}if(r)return this.modifyTable(e,i);for(let e=0,o=n,t=s.length,r;e<t;++e,++o)if((r=s[e])instanceof Array)l.setColumn(""+o,r);else for(let e=0,t=a.length;e<t;++e)l.setCell(""+o,e,r[a[e]],i);return e}modifyTable(r,e){this.emit({type:"modify",detail:e,table:r});const t=r.modified;if(r.hasColumns(["columnNames"])){const s=((r.deleteColumns(["columnNames"])||{}).columnNames||[]).map(e=>""+e),n={};for(let e=0,t=r.getRowCount(),o;e<t;++e)(o=r.getRow(e))&&(n[s[e]]=o);t.deleteColumns(),t.setColumns(n)}else{const i={};for(let e=0,t=r.getRowCount(),o;e<t;++e)(o=r.getRow(e))&&(i[""+e]=o);i.columnNames=r.getColumnNames(),t.deleteColumns(),t.setColumns(i)}return this.emit({type:"afterModify",detail:e,table:r}),r}}return r.defaultOptions={type:"Invert"},e.registerType("Invert",r),r}),t(e,"Data/Modifiers/MathModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Data/Formula/FormulaParser.js"],e["Data/Formula/FormulaProcessor.js"]],function(e,u,a){class t extends e{constructor(e){super(),this.options={...t.defaultOptions,...e}}modifyTable(s,e){var n=this;n.emit({type:"modify",detail:e,table:s});const i=n.options.alternativeSeparators,r=n.options.formulaColumns||s.getColumnNames(),a=s.modified;for(let e=0,t=r.length,o;e<t;++e)o=r[e],0<=r.indexOf(o)&&a.setColumn(o,n.processColumn(s,o));var l=n.options.columnFormulas||[];for(let e=0,t=l.length,o,r;e<t;++e)o=l[e],r=u.parseFormula(o.formula,i),a.setColumn(o.column,n.processColumnFormula(r,s,o.rowStart,o.rowEnd));return n.emit({type:"afterModify",detail:e,table:s}),s}processColumn(s,e,t=0){const n=this.options.alternativeSeparators,i=(s.getColumn(e,!0)||[]).slice(0<t?t:0);for(let e=0,t=i.length,o=[],r;e<t;++e)if("string"==typeof(r=i[e])&&"="===r[0])try{o=""===r?o:u.parseFormula(r.substring(1),n),i[e]=a.processFormula(o,s)}catch{i[e]=NaN}return i}processColumnFormula(o,e,r=0,s=e.getRowCount()){r=0<=r?r:0,s=0<=s?s:e.getRowCount()+s;const n=[],i=e.modified;for(let e=0,t=s-r;e<t;++e)try{n[e]=a.processFormula(o,i)}catch{n[e]=NaN}finally{o=a.translateReferences(o,0,1)}return n}}return t.defaultOptions={type:"Math",alternativeSeparators:!1},e.registerType("Math",t),t}),t(e,"Data/Modifiers/RangeModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(e,t){const o=t["merge"];class r extends e{constructor(e){super(),this.options=o(r.defaultOptions,e)}modifyTable(l,e){this.emit({type:"modify",detail:e,table:l});var{additive:u,ranges:o,strict:c}=this.options;if(o.length){const m=l.modified;let i=l.getColumns(),a=[];for(let e=0,t=o.length,s,n;e<t;++e)if(s=o[e],!c||typeof s.minValue==typeof s.maxValue){0<e&&!u&&(m.deleteRows(),m.setRows(a),i=m.getColumns(),a=[]);for(let e=0,t=(n=i[s.column]||[]).length,o,r;e<t;++e){switch(typeof(o=n[e])){default:continue;case"boolean":case"number":case"string":}c&&typeof o!=typeof s.minValue||o>=s.minValue&&o<=s.maxValue&&(r=(u?l:m).getRow(e))&&a.push(r)}}m.deleteRows(),m.setRows(a)}return this.emit({type:"afterModify",detail:e,table:l}),l}}return r.defaultOptions={type:"Range",ranges:[]},e.registerType("Range",r),r}),t(e,"Data/Modifiers/SortModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,a,t){const o=t["merge"];class d extends e{static ascending(e,t){return(e||0)<(t||0)?-1:(t||0)<(e||0)?1:0}static descending(e,t){return(t||0)<(e||0)?-1:(e||0)<(t||0)?1:0}constructor(e){super(),this.options=o(d.defaultOptions,e)}getRowReferences(e){const o=e.getRows(),r=[];for(let e=0,t=o.length;e<t;++e)r.push({index:e,row:o[e]});return r}modifyCell(e,t,o,r,s){var{orderByColumn:n,orderInColumn:i}=this.options;return t===n&&(i?(e.modified.setCell(t,o,r),e.modified.setColumn(i,this.modifyTable(new a({columns:e.getColumns([n,i])})).modified.getColumn(i))):this.modifyTable(e,s)),e}modifyColumns(e,t,o,r){const{orderByColumn:s,orderInColumn:n}=this.options,i=Object.keys(t);return-1<i.indexOf(s)&&(n&&t[i[0]].length?(e.modified.setColumns(t,o),e.modified.setColumn(n,this.modifyTable(new a({columns:e.getColumns([s,n])})).modified.getColumn(n))):this.modifyTable(e,r)),e}modifyRows(e,t,o,r){var{orderByColumn:s,orderInColumn:n}=this.options;return n&&t.length?(e.modified.setRows(t,o),e.modified.setColumn(n,this.modifyTable(new a({columns:e.getColumns([s,n])})).modified.getColumn(n))):this.modifyTable(e,r),e}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});const o=e.getColumnNames(),r=e.getRowCount(),s=this.getRowReferences(e),{direction:n,orderByColumn:i,orderInColumn:a}=this.options,l="asc"===n?d.ascending:d.descending,u=o.indexOf(i),c=e.modified;if(-1!==u&&s.sort((e,t)=>l(e.row[u],t.row[u])),a){const m=[];for(let e=0;e<r;++e)m[s[e].index]=e;c.setColumns({[a]:m})}else{const f=[];for(let e=0;e<r;++e)f.push(s[e].row);c.setRows(f,0)}return this.emit({type:"afterModify",detail:t,table:e}),e}}return d.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"},e.registerType("Sort",d),d}),t(e,"masters/modules/data-tools.src.js",[e["Core/Globals.js"],e["Data/Connectors/DataConnector.js"],e["Data/Converters/DataConverter.js"],e["Data/DataCursor.js"],e["Data/Modifiers/DataModifier.js"],e["Data/DataPool.js"],e["Data/DataTable.js"],e["Data/Formula/Formula.js"]],function(e,t,o,r,s,n,i,a){const l=e;return l.DataConnector=l.DataConnector||t,l.DataConverter=l.DataConverter||o,l.DataCursor=l.DataCursor||r,l.DataModifier=l.DataModifier||s,l.DataPool=l.DataPool||n,l.DataTable=l.DataTable||i,l.Formula=l.Formula||a,e})});